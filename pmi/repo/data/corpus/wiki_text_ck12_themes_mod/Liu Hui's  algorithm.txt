Liu Hui's algorithm was invented by Liu Hui (fl. 3rd century), a mathematician of Wei Kingdom. Before his time, the ratio of the circumference of a circle to diameter was often taken experimentally as three in China, while Zhang Heng (78139) rendered it as 3.1724 (from the proportion of the celestial circle to the diameter of the earth, 92/29) or as . Liu Hui was not satisfied with this value. He commented that it was too large and overshot the mark. Another mathematician Wan Fan (219257) provided 142/45 3.156. All these empirical values were accurate to two digits (i.e. one decimal place). Liu Hui was the first Chinese mathematician to provide a rigorous algorithm for calculation of to any accuracy. Liu Hui's own calculation with a 96-gon provided an accuracy of five digits: 3.1416. Liu Hui remarked in his commentary to the The Nine Chapters on the Mathematical Art, that the ratio of the circumference of an inscribed hexagon to the diameter of the circle was three, hence must be greater than three. He went on to provide a detailed step-by-step description of an iterative algorithm to calculate to any required accuracy based on bisecting polygons; he calculated to between 3.141024 and 3.142708 with a 96-gon; he suggested that 3.14 was a good enough approximation, and expressed as 157/50; he admitted that this number was a bit small. Later he invented an ingenious quick method to improve on it, and obtained 3.1416 with only a 96-gon, with an accuracy comparable to that from a 1536-gon. His most important contribution in this area was his simple iterative algorithm. Liu Hui argued: "Multiply one side of a hexagon by the radius (of its circumcircle), then multiply this by three, to yield the area of a dodecagon; if we cut a hexagon into a dodecagon, multiply its side by its radius, then again multiply by six, we get the area of a 24-gon; the finer we cut, the smaller the loss with respect to the area of circle, thus with further cut after cut, the area of the resulting polygon will coincide and become one with the circle; there will be no loss". Apparently Liu Hui had already mastered the concept of the limit Further, Liu Hui proved that the area of a circle is half of its circumference multiplied by its radius. He said: "Between a polygon and a circle, there is excess radius. Multiply the excess radius by a side of the polygon. The resulting area exceeds the boundary of the circle". In the diagram d = excess radius. Multiplying d by one side results in oblong ABCD which exceeds the boundary of the circle. If a side of the polygon is small (i.e. there is a very large number of sides), then the excess radius will be small, hence excess area will be small. As in the diagram, when N , d 0, and ABCD 0. "Multiply the side of a polygon by its radius, and the area doubles; hence multiply half the circumference by the radius to yield the area of circle". When N , half the circumference of the N-gon approaches a semicircle, thus half a circumference of a circle multiplied by its radius equals the area of the circle. Liu Hui did not explain in detail this deduction. However it is self-evident by using Liu Hui's "in-out complement principle" which he provided elsewhere in The Nine Chapters on the Mathematical Art: Cut up a geometric shape into parts, rearrange the parts to form another shape, the area of the two shapes will be identical. Thus rearranging the six green triangles, three blue triangles and three red triangles into a rectangle with width = 3L, and height R shows that the area of the dodecagon = 3RL. In general, multiplying half of the circumference of a N-gon by its radius yields the area of a 2N-gon. Liu Hui used this result repetitively in his algorithm. Liu Hui proved an inequality involving by considering the area of inscribed polygons with N and 2N sides. In the diagram, the yellow area represents the area of an N-gon, denoted by , and the yellow area plus the green area represents the area of a 2N-gon, denoted by . Therefore the green area represents the difference between the areas of the 2N-gon and the N-gon: The red area is equal to the green area, and so is also . So Yellow area + green area + red area = Let C represent the area of the circle. Then If the radius of the circle is taken to be 1, then we have Liu Hui's inequality: Liu Hui began with an inscribed hexagon. Let M be the length of one side AB of hexagon, r is the radius of circle. Bisect AB with line OPC, AC becomes one side of dodecagon, let its length be m. AOP, APC are two right angle triangles. Liu Hui used Gou Gu theorem repetitively: With r = 10 units, he obtained area of 48-gon area of 96-gon Difference of 96-gon and 48-gon: from Liu Hui's inequality: Since r = 10, C = therefore: He never took as the average of the lower limit 3.141024 and upper limit 3.142704. Instead he suggested that 3.14 was a good enough approximation for , and expressed it as a fraction ; he pointed out this number is slightly less than the real thing. Liu Hui carried out his calculation with rod calculus, and expressed his results with fractions. However, the iterative nature of Liu Hui's algorithm is quite clear: in which m is the length of one side of next order polygon bisected from M, then repeat the same calculation, each step required only one addition, one square root extraction. Calculation of square roots of irrational numbers was not an easy task in the third century with counting rods. Liu Hui discovered a short cut by comparing the area differentials of polygons, and found that the proportion of the difference in area of successive order polygons was approximately 1/4. Let DN denote the difference in areas of N-gon and (N/2)-gon He found: 1 Hence: Area of unit radius circle = In which That is all the subsequent excess areas add up amount to one third of the area of unit circle2 Liu Hui was quite happy with this result because he had acquired the same result with the calculation for a 1536-gon, obtaining the area of a 3072-gon. This explains four questions: Why he stopped short at A192 in his presentation of his algorithm. Because he discovered a quick method of improving the accuracy of , achieving same result of 1536-gon with only 96-gon. After all calculation of square roots was not a simple task with rod calculus. With the quick method, he only needed to perform one more subtraction, one more division (by 3) and one more addition, instead of four more square root extractions. Why he preferred to calculate through calculation of areas instead of circumferences of successive polygons, because the quick method required information about the difference in areas of successive polygons. Who was the true author of the paragraph containing calculation of That famous paragraph began with "A Han dynasty bronze container in the military warehouse of Jin dynasty....". Many scholars, among them Yoshio Mikami and Joseph Needham, believed that the "Han dynasty bronze container" paragraph was the work of Liu Hui and not Zu Chongzhi as other believed, because of the strong correlation of the two methods through area calculation, and because there was not a single word mentioning Zu's 3.1415926 < < 3.1415927 result obtained through 12288-gon. Liu Hui established a solid algorithm for calculation of to any accuracy. Zu Chongzhi was familiar with Liu Hui's work, and obtained greater accuracy by applying his algorithm to a 12288-gon. From Liu Hui's formula for 2N-gon: For 12288-gon inscribed in a unit radius circle: . From Liu Hui's inequality: In which . Therefore Truncated to eight significant digits: . That was the famous Zu Chongzhi inequality. Zu Chongzhi then used the interpolation formula by He Chengtian (, 370-447) and obtained an approximating fraction: . However, this value disappeared in Chinese history for a long period of time (e.g. Song dynasty mathematician Qin Jiushao used = and ), until Yuan dynasty mathematician Zhao Yuqin worked on a variation of Liu Hui's algorithm, by bisecting an inscribed square and obtained again Liu Hui's algorithm was one of his most important contributions to ancient Chinese mathematics. It was based on calculation of N-gon area, in contrast to the Archimedean algorithm based on polygon circumference. Archimedes used a circumscribed 96-gon to obtain an upper limit , and an inscribed 96-gon to obtain the lower limit . Liu Hui was able to obtain both his upper limit 3.142704 and lower limit 3.141024 with only an inscribed 96-gon. Furthermore, both the Liu Hui limits were tighter than Archimedes's: 3.140845 < 3.141024 < < 3.142704 < 3.142857. With his method Zu Chongzhi obtained the result: 3.1415926 < < 3.1415927, which held the world record for the most accurate value of for 1200 years, even by 1600 in Europe, mathematician Adriaen Anthoniszoom and his son obtained value of 3.1415929, accurate only to 7 digit, still 3 digits short of Zu's result ^1 Correct value: 0.2502009052 ^2 Correct values: Liu Hui's quick method was potentially able to deliver almost the same result of 12288-gon (3.141592516588) with only 96-gon. 